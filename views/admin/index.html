<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Panel Admin - Inicio</title>
    <link rel="stylesheet" href="../../Public/styles/admin.css" />
</head>
<body>
    <div class="admin-container">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>Admin</h2>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="#" id="dashboardLink" class="active">Dashboard</a></li>
                    <li><a href="#" id="usersLink">Usuarios</a></li>
                    <li><a href="#" id="offersLink">Ofertas</a></li>
                    <!-- <li><a href="#" id="reportsLink">Reportes</a></li> -->
                    <!-- <li><a href="#" id="metricsLink">Métricas</a></li> -->
                    <!-- <li><a href="#" id="administradoresLink">Administradores</a></li>-->
                </ul>
            </nav>
        </aside>
        <div class="main-content">
            <header class="main-header">
                <h1>Panel de Administración</h1>
                <div class="user-info">
                    <span>Hola, Admin</span>
                </div>
            </header>
            <main>
                <section class="dashboard-cards" id="dashboardSection">
                    <div class="card">
                        <h2>Información General</h2>
                        <p>Bienvenido al panel de administración. Aquí puedes gestionar usuarios, ofertas, reportes y métricas.</p>
                        <ul>
                            <li>Total de usuarios registrados: <strong id="totalUsers">--</strong></li>
                            <li>Total de ofertas publicadas: <strong id="totalOffers">--</strong></li>
                        </ul>
                    </div>
                    <div class="card">
                        <h2>Guía de Uso</h2>
                        <ol>
                            <li>Utiliza el menú lateral para navegar entre las secciones.</li>
                            <li>En cada sección puedes agregar, editar o eliminar registros.</li>
                            <li>Para agregar un nuevo registro, haz clic en el botón "Agregar".</li>
                            <li>Para editar o eliminar, utiliza los botones correspondientes en cada fila de la tabla.</li>
                            <li>Recuerda guardar los cambios antes de salir de cada formulario.</li>
                        </ol>
                    </div>
                </section>
                <section class="dashboard-cards" id="usersSection" style="display:none;">
                    <div class="card">
                        <!-- Botón "Agregar Usuario" eliminado según solicitud -->
                        <table id="usersTable" border="1">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>tipo de usuario</th>
                                    <th>Es Empresa</th>
                                    <th>rol</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Usuarios cargados dinámicamente con botones Editar y Eliminar -->
                            </tbody>
                        </table>
                    </div>
                    <div class="card" id="userFormSection" style="display:none;">
                        <h2 id="formTitle">Editar Usuario</h2>
                        <form id="userForm">
                            <input type="hidden" id="userId" />
                            <label for="nombre">Nombre:</label>
                            <input type="text" id="nombre" name="nombre" required />
                            <label for="correo">Email:</label>
                            <input type="email" id="correo" name="correo" required />
                            <label for="id_rol">Rol:</label>
                            <select id="id_rol" name="id_rol" required>
                                <option value="1">Empresa</option>
                                <option value="2">Usuario</option>
                                <option value="3">Admin</option>
                            </select>
                            <label for="esEmpresa">Es Empresa:</label>
                            <select id="esEmpresa" name="esEmpresa" required>
                                <option value="0">No</option>
                                <option value="1">Sí</option>
                            </select>
                            <button type="submit">Guardar</button>
                            <button type="button" id="btnCancel">Cancelar</button>
                        </form>
                    </div>
                </section>
                <section class="dashboard-cards" id="administradoresSection" style="display:none;">
                    <div class="card">
                        <button id="btnAddAdministrador">Agregar Administrador</button>
                        <table id="administradoresTable" border="1">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Email</th>
                                    <th>Permisos</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Administradores cargados dinámicamente -->
                            </tbody>
                        </table>
                    </div>
                    <div class="card" id="administradorFormSection" style="display:none;">
                        <h2>Agregar Administrador</h2>
                        <form id="administradorForm">
                            <label for="id_usuario">ID Usuario:</label>
                            <input type="number" id="id_usuario" name="id_usuario" required />
                            <label for="permisos">Permisos:</label>
                            <textarea id="permisos" name="permisos"></textarea>
                            <button type="submit">Guardar</button>
                            <button type="button" id="btnCancelAdministrador">Cancelar</button>
                        </form>
                    </div>
                </section>
                <section class="dashboard-cards" id="offersSection" style="display:none;">
                    <div class="card">
                        <!-- Botón "Agregar Oferta" eliminado según solicitud -->
                        <table id="offersTable" border="1">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Título</th>
                                    <th>Descripción</th>
                                    <th>Empresa ID</th>
                                    <th>Fecha Publicación</th>
                                    <th>Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="card" id="offerFormSection" style="display:none;">
                        <h2 id="formTitle">Editar Oferta</h2>
                        <form id="offerForm">
                            <input type="hidden" id="offerId" />
                            <label for="titulo">Título:</label>
                            <input type="text" id="titulo" name="titulo" required />
                            <label for="descripcion">Descripción:</label>
                            <textarea id="descripcion" name="descripcion" required></textarea>
                            <label for="empresaId">Empresa ID:</label>
                            <input type="number" id="empresaId" name="empresaId" required />
                            <label for="fechaPublicacion">Fecha Publicación:</label>
                            <input type="date" id="fechaPublicacion" name="fechaPublicacion" required />
                            <button type="submit">Guardar</button>
                            <button type="button" id="btnCancel">Cancelar</button>
                        </form>
                    </div>
                </section>
                    <div class="card" id="reportFormSection" style="display:none;">
                        <h2 id="formTitle">Editar Reporte</h2>
                        <form id="reportForm">
                            <input type="hidden" id="reportId" />
                            <label for="titulo">Título:</label>
                            <input type="text" id="titulo" name="titulo" required />
                            <label for="descripcion">Descripción:</label>
                            <textarea id="descripcion" name="descripcion" required></textarea>
                            <label for="fechaReporte">Fecha Reporte:</label>
                            <input type="date" id="fechaReporte" name="fechaReporte" required />
                            <button type="submit">Guardar</button>
                            <button type="button" id="btnCancel">Cancelar</button>
                        </form>
            </main>
        </div>
    </div>
    <script src="../../Public/admin/admin.js"></script>
<!-- Code injected by live-server -->
<script>
	// <![CDATA[  <-- For SVG support
	if ('WebSocket' in window) {
		(function () {
			function refreshCSS() {
				var sheets = [].slice.call(document.getElementsByTagName("link"));
				var head = document.getElementsByTagName("head")[0];
				for (var i = 0; i < sheets.length; ++i) {
					var elem = sheets[i];
					var parent = elem.parentElement || head;
					parent.removeChild(elem);
					var rel = elem.rel;
					if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
						var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
						elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
					}
					parent.appendChild(elem);
				}
			}
			var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
			var address = protocol + window.location.host + window.location.pathname + '/ws';
			var socket = new WebSocket(address);
			socket.onmessage = function (msg) {
				if (msg.data == 'reload') window.location.reload();
				else if (msg.data == 'refreshcss') refreshCSS();
			};
			if (sessionStorage && !sessionStorage.getItem('IsThisFirstTime_Log_From_LiveServer')) {
				console.log('Live reload enabled.');
				sessionStorage.setItem('IsThisFirstTime_Log_From_LiveServer', true);
			}
		})();
	}
	else {
		console.error('Upgrade your browser. This Browser is NOT supported WebSocket for Live-Reloading.');
	}
	// ]]>
</script>
</body>
</html>
